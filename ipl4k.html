<!DOCTYPE html>
<html>
<head>
<title>IPL 4K</title>
	<link rel="stylesheet" href="https://cdn.plyr.io/3.6.8/plyr.css" />
	<script src="https://cdn.plyr.io/3.6.8/plyr.polyfilled.js"></script>
</head>
<body>

<video controls crossorigin playsinline poster="https://t3.ftcdn.net/jpg/03/00/38/90/360_F_300389025_b5hgHpjDprTySl8loTqJRMipySb1rO0I.jpg"></video>
<script src="https://cdn.jsdelivr.net/npm/hls.js"></script>
<script src="https://unpkg.com/plyr@3"></script>
<script src="./script.js"></script>

  <div class="container">
   
    <video controls crossorigin playsinline poster="https://t3.ftcdn.net/jpg/03/00/38/90/360_F_300389025_b5hgHpjDprTySl8loTqJRMipySb1rO0I.jpg"
      <source 
        type="application/x-mpegURL" 
        src="https://prod-ent-live-gm.jiocinema.com/out/v1/81e640e5a2c74eb98201959a31a008a3/master.m3u8"
      >
    </video>
  </div>
</div>


<style type="text/css">
	.container {
	margin: 20px auto;
	width: 600px;
}
video {
	width: 100%;
}
</style>

<script type="text/javascript">
	document.addEventListener("DOMContentLoaded", () => {
  const video = document.querySelector("video");
  const source = video.getElementsByTagName("https://prod-ent-live-gm.jiocinema.com/out/v1/81e640e5a2c74eb98201959a31a008a3/master.m3u8")[0].src;
  
  const defaultOptions = {};

  if (Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(source);

    
    hls.on(Hls.Events.MANIFEST_PARSED, function (event, data) {


      const availableQualities = hls.levels.map((l) => l.height)


      defaultOptions.quality = {
        default: availableQualities[0],
        options: availableQualities,
        
        forced: true,        
        onChange: (e) => updateQuality(e),
      }

      
      const player = new Plyr(video, defaultOptions);
    });
    hls.attachMedia(video);
    window.hls = hls;
  } else {

    const player = new Plyr(video, defaultOptions);
  }

  function updateQuality(newQuality) {
    window.hls.levels.forEach((level, levelIndex) => {
      if (level.height === newQuality) {
        console.log("Found quality match with " + newQuality);
        window.hls.currentLevel = levelIndex;
      }
    });
  }
});
</script>

</body>
</html>
